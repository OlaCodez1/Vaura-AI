<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vaura Login</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      signInWithPopup,
      GoogleAuthProvider,
      GithubAuthProvider,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      signOut
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAW4gJsNCJhMFmmkHIOk2-aWbvEsqcFvGg",
      authDomain: "vaura-app.firebaseapp.com",
      projectId: "vaura-app",
      storageBucket: "vaura-app.appspot.com",
      messagingSenderId: "293235650565",
      appId: "1:293235650565:web:347f15d4727cda1897ec6c",
      measurementId: "G-H559D7SFMS"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const googleProvider = new GoogleAuthProvider();
    const githubProvider = new GithubAuthProvider();

    const choiceView = document.getElementById("auth-choice");
    const emailLoginView = document.getElementById("email-login");
    const emailSignupView = document.getElementById("email-signup");
    const dashView = document.getElementById("dashboard");
    const userName = document.getElementById("user-name");
    const userEmail = document.getElementById("user-email");
    const userAvatar = document.getElementById("user-avatar");
    const continueBtn = document.getElementById("continue-btn");
    const themeToggle = document.getElementById("theme-toggle");

    function show(el) {
      [choiceView, emailLoginView, emailSignupView, dashView].forEach(v => v.style.display = 'none');
      el.style.display = 'block';
    }

    window.googleLogin = () => {
      signInWithPopup(auth, googleProvider)
        .then(res => updateDashboard(res.user))
        .catch(err => alert(err.message));
    };

    window.githubLogin = () => {
      signInWithPopup(auth, githubProvider)
        .then(res => updateDashboard(res.user))
        .catch(err => alert(err.message));
    };

    window.emailLogin = () => {
      const email = document.getElementById("login-email").value;
      const pass = document.getElementById("login-password").value;
      signInWithEmailAndPassword(auth, email, pass)
        .then(res => updateDashboard(res.user))
        .catch(err => alert(err.message));
    };

    window.emailSignup = () => {
      const email = document.getElementById("signup-email").value;
      const pass = document.getElementById("signup-password").value;
      createUserWithEmailAndPassword(auth, email, pass)
        .then(res => updateDashboard(res.user))
        .catch(err => alert(err.message));
    };

    window.logout = () => {
      signOut(auth);
      show(choiceView);
    };

    window.showEmailLogin = () => show(emailLoginView);
    window.showEmailSignup = () => show(emailSignupView);
    window.showAuthChoice = () => show(choiceView);

    function updateDashboard(user) {
      userName.textContent = user.displayName || "Anonymous";
      userEmail.textContent = user.email;

      if (user.photoURL) {
        userAvatar.src = user.photoURL;
        userAvatar.style.display = 'block';
      } else {
        userAvatar.style.display = 'none';
      }

      const deepLink = `vaura://login?uid=${encodeURIComponent(user.uid)}` +
                       `&email=${encodeURIComponent(user.email || '')}` +
                       `&name=${encodeURIComponent(user.displayName || '')}` +
                       `&photo=${encodeURIComponent(user.photoURL || '')}`;

      continueBtn.onclick = () => {
        window.location.href = deepLink;
        setTimeout(() => {
          window.location.href = "/app-not-installed.html";
        }, 500);
      };

      show(dashView);
    }

    function setTheme(isDark) {
      document.body.className = isDark ? 'dark-mode' : 'light-mode';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      themeToggle.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
    }

    themeToggle.addEventListener('click', () => {
      const isDark = !document.body.classList.contains('dark-mode');
      setTheme(isDark);
    });

    const savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme === 'dark');

    onAuthStateChanged(auth, user => {
      if (user) updateDashboard(user);
      else show(choiceView);
    });
  </script>
  <style>
    /* Base colors */
:root {
  --primary: #FF4D79;
  --secondary: #6C5CE7;
  --dark: #2D3436;
  --light: #F5F6FA;
  --text: #2D3436;
  --card-bg: white;
  --bg: #F5F6FA;
  --transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.dark-mode {
  --primary: #FF4D79;
  --secondary: #8A7CFF;
  --dark: #121212;
  --light: #1E1E1E;
  --text: #F5F6FA;
  --card-bg: #1E1E1E;
  --bg: #121212;
}

/* Reset */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Inter', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: var(--bg);
  color: var(--text);
  transition: background-color 0.5s ease, color 0.5s ease;
  background-image: radial-gradient(circle at 25% 25%, rgba(108,92,231,0.1), transparent 50%),
                    radial-gradient(circle at 75% 75%, rgba(255,77,121,0.1), transparent 50%);
}

.card {
  background: var(--card-bg);
  padding: 2.5rem;
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  width: 380px;
  max-width: 95%;
  text-align: center;
  display: none;
  position: relative;
  overflow: hidden;
  animation: fadeIn 0.6s ease-out forwards;
}

h2 {
  margin-bottom: 1.5rem;
  font-size: 1.8rem;
  font-weight: 700;
}

.avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  border: 3px solid var(--primary);
  object-fit: cover;
  margin: 0 auto 1rem;
  display: none;
}

input {
  width: 100%;
  padding: 0.9rem 1.2rem;
  margin: 0.7rem 0;
  border-radius: 10px;
  border: none;
  background: rgba(0,0,0,0.05);
  color: var(--text);
  font-size: 0.95rem;
  transition: var(--transition);
}

.dark-mode input {
  background: rgba(255,255,255,0.1);
}

input:focus {
  outline: none;
  background: rgba(0,0,0,0.1);
  box-shadow: 0 0 0 2px var(--primary);
}

.dark-mode input:focus {
  background: rgba(255,255,255,0.15);
}

input::placeholder {
  color: rgba(0,0,0,0.5);
}

.dark-mode input::placeholder {
  color: rgba(255,255,255,0.6);
}

.btn {
  width: 100%;
  padding: 0.9rem;
  margin: 0.7rem 0;
  border: none;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: var(--transition);
  font-size: 0.95rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.6rem;
  position: relative;
  overflow: hidden;
}

.btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(108,92,231,0.4);
}

.btn::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: 0.5s;
}

.btn:hover::after {
  left: 100%;
}

.btn-google { background: #4285F4; }
.btn-github { background: #333; }
.btn-email {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
}
.btn-email:hover {
  background: var(--primary);
  color: white;
}
.btn-logout {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
}
.btn-logout:hover {
  background: var(--primary);
  color: white;
}

#continue-btn {
  background: linear-gradient(135deg, #6C5CE7, #00CEFF);
  margin-top: 1.5rem;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.auth-options {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
}
.auth-options .btn {
  flex: 1;
  padding: 0.7rem;
  font-size: 0.9rem;
}

.switch {
  margin-top: 1.2rem;
  color: var(--text);
  opacity: 0.7;
  cursor: pointer;
  font-size: 0.9rem;
  transition: var(--transition);
}
.switch:hover {
  color: var(--primary);
  opacity: 1;
}

.divider {
  display: flex;
  align-items: center;
  margin: 1.5rem 0;
  color: rgba(0,0,0,0.3);
}
.dark-mode .divider { color: rgba(255,255,255,0.3); }
.divider::before, .divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: rgba(0,0,0,0.1);
}
.dark-mode .divider::before, .dark-mode .divider::after {
  background: rgba(255,255,255,0.1);
}
.divider span {
  padding: 0 1rem;
  font-size: 0.8rem;
}

.user-info {
  margin-bottom: 2rem;
}
.user-info h3 {
  font-size: 1.3rem;
  margin-bottom: 0.3rem;
}
.user-info p {
  opacity: 0.7;
  font-size: 0.95rem;
}

.theme-toggle {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  background: none;
  border: none;
  color: var(--text);
  font-size: 1.2rem;
  cursor: pointer;
  transition: var(--transition);
}
.theme-toggle:hover {
  color: var(--primary);
  transform: scale(1.1);
}

.floating-shapes {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: -1;
}
.shape {
  position: absolute;
  opacity: 0.1;
  animation: float 15s infinite linear;
  border-radius: 50%;
  filter: blur(20px);
}
.shape:nth-child(1) {
  width: 200px;
  height: 200px;
  background: var(--primary);
  top: 20%;
  left: 10%;
  animation-duration: 20s;
}
.shape:nth-child(2) {
  width: 300px;
  height: 300px;
  background: var(--secondary);
  top: 60%;
  left: 80%;
  animation-duration: 25s;
}
.shape:nth-child(3) {
  width: 150px;
  height: 150px;
  background: var(--primary);
  top: 80%;
  left: 20%;
  animation-duration: 18s;
}

@keyframes float {
  0% { transform: translate(0,0) rotate(0deg); }
  25% { transform: translate(10px,10px) rotate(5deg); }
  50% { transform: translate(20px,-10px) rotate(-5deg); }
  75% { transform: translate(-10px,15px) rotate(5deg); }
  100% { transform: translate(0,0) rotate(0deg); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

  </style>
</head>
<body class="dark-mode">
  <button id="theme-toggle" class="theme-toggle">
    <i class="fas fa-sun"></i>
  </button>

  <div class="floating-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
  </div>

  <div id="auth-choice" class="card">
    <h2>Welcome to Vaura</h2>
    <button class="btn btn-google" onclick="googleLogin()">
      <i class="fab fa-google"></i> Continue with Google
    </button>
    <button class="btn btn-github" onclick="githubLogin()">
      <i class="fab fa-github"></i> Continue with GitHub
    </button>
    <div class="divider"><span>OR</span></div>
    <div class="auth-options">
      <button class="btn btn-email" onclick="showEmailLogin()">
        <i class="fas fa-sign-in-alt"></i> Sign In
      </button>
      <button class="btn btn-email" onclick="showEmailSignup()">
        <i class="fas fa-user-plus"></i> Sign Up
      </button>
    </div>
  </div>

  <div id="email-login" class="card">
    <h2>Sign In</h2>
    <input id="login-email" type="email" placeholder="Email Address" />
    <input id="login-password" type="password" placeholder="Password" />
    <button class="btn" onclick="emailLogin()">
      <i class="fas fa-sign-in-alt"></i> Sign In
    </button>
    <div class="switch" onclick="showAuthChoice()">
      <i class="fas fa-arrow-left"></i> Back to all options
    </div>
  </div>

  <div id="email-signup" class="card">
    <h2>Create Account</h2>
    <input id="signup-email" type="email" placeholder="Email Address" />
    <input id="signup-password" type="password" placeholder="Password" />
    <button class="btn" onclick="emailSignup()">
      <i class="fas fa-user-plus"></i> Create Account
    </button>
    <div class="switch" onclick="showAuthChoice()">
      <i class="fas fa-arrow-left"></i> Back to all options
    </div>
  </div>

  <div id="dashboard" class="card">
    <img id="user-avatar" class="avatar" alt="User Avatar">
    <div class="user-info">
      <h3 id="user-name">User</h3>
      <p id="user-email"></p>
    </div>
    <button class="btn btn-logout" onclick="logout()">
      <i class="fas fa-sign-out-alt"></i> Sign Out
    </button>
    <button class="btn" id="continue-btn">
      <i class="fas fa-arrow-right"></i> Continue to App
    </button>
  </div>
</body>
</html>